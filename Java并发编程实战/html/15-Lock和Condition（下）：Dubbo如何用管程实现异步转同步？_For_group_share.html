<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>15-Lockå’ŒConditionï¼ˆä¸‹ï¼‰ï¼šDubboå¦‚ä½•ç”¨ç®¡ç¨‹å®ç°å¼‚æ­¥è½¬åŒæ­¥ï¼Ÿ</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>15-Lockå’ŒConditionï¼ˆä¸‹ï¼‰ï¼šDubboå¦‚ä½•ç”¨ç®¡ç¨‹å®ç°å¼‚æ­¥è½¬åŒæ­¥ï¼Ÿ</h1>
<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²åˆ°Java SDKå¹¶å‘åŒ…é‡Œçš„Lockæœ‰åˆ«äºsynchronizedéšå¼é”çš„ä¸‰ä¸ªç‰¹æ€§ï¼šèƒ½å¤Ÿå“åº”ä¸­æ–­ã€æ”¯æŒè¶…æ—¶å’Œéé˜»å¡åœ°è·å–é”ã€‚é‚£ä»Šå¤©æˆ‘ä»¬æ¥ç€å†æ¥è¯¦ç»†èŠèŠJava SDKå¹¶å‘åŒ…é‡Œçš„Conditionï¼Œ<strong>Conditionå®ç°äº†ç®¡ç¨‹æ¨¡å‹é‡Œé¢çš„æ¡ä»¶å˜é‡</strong>ã€‚</p><p>åœ¨<a href="https://time.geekbang.org/column/article/86089">ã€Š08 | ç®¡ç¨‹ï¼šå¹¶å‘ç¼–ç¨‹çš„ä¸‡èƒ½é’¥åŒ™ã€‹</a>é‡Œæˆ‘ä»¬æåˆ°è¿‡Java è¯­è¨€å†…ç½®çš„ç®¡ç¨‹é‡Œåªæœ‰ä¸€ä¸ªæ¡ä»¶å˜é‡ï¼Œè€ŒLock&amp;Conditionå®ç°çš„ç®¡ç¨‹æ˜¯æ”¯æŒå¤šä¸ªæ¡ä»¶å˜é‡çš„ï¼Œè¿™æ˜¯äºŒè€…çš„ä¸€ä¸ªé‡è¦åŒºåˆ«ã€‚</p><p>åœ¨å¾ˆå¤šå¹¶å‘åœºæ™¯ä¸‹ï¼Œæ”¯æŒå¤šä¸ªæ¡ä»¶å˜é‡èƒ½å¤Ÿè®©æˆ‘ä»¬çš„å¹¶å‘ç¨‹åºå¯è¯»æ€§æ›´å¥½ï¼Œå®ç°èµ·æ¥ä¹Ÿæ›´å®¹æ˜“ã€‚ä¾‹å¦‚ï¼Œå®ç°ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œå°±éœ€è¦ä¸¤ä¸ªæ¡ä»¶å˜é‡ã€‚</p><p><strong>é‚£å¦‚ä½•åˆ©ç”¨ä¸¤ä¸ªæ¡ä»¶å˜é‡å¿«é€Ÿå®ç°é˜»å¡é˜Ÿåˆ—å‘¢ï¼Ÿ</strong></p><p>ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œéœ€è¦ä¸¤ä¸ªæ¡ä»¶å˜é‡ï¼Œä¸€ä¸ªæ˜¯é˜Ÿåˆ—ä¸ç©ºï¼ˆç©ºé˜Ÿåˆ—ä¸å…è®¸å‡ºé˜Ÿï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯é˜Ÿåˆ—ä¸æ»¡ï¼ˆé˜Ÿåˆ—å·²æ»¡ä¸å…è®¸å…¥é˜Ÿï¼‰ï¼Œè¿™ä¸ªä¾‹å­æˆ‘ä»¬å‰é¢åœ¨ä»‹ç»<a href="https://time.geekbang.org/column/article/86089">ç®¡ç¨‹</a>çš„æ—¶å€™è¯¦ç»†è¯´è¿‡ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚ç›¸å…³çš„ä»£ç ï¼Œæˆ‘è¿™é‡Œé‡æ–°åˆ—äº†å‡ºæ¥ï¼Œä½ å¯ä»¥æ¸©æ•…çŸ¥æ–°ä¸€ä¸‹ã€‚</p><pre><code>public class BlockedQueue&lt;T&gt;{
  final Lock lock =
    new ReentrantLock();
  // æ¡ä»¶å˜é‡ï¼šé˜Ÿåˆ—ä¸æ»¡  
  final Condition notFull =
    lock.newCondition();
  // æ¡ä»¶å˜é‡ï¼šé˜Ÿåˆ—ä¸ç©º  
  final Condition notEmpty =
    lock.newCondition();

  // å…¥é˜Ÿ
  void enq(T x) {
    lock.lock();
    try {
      while (é˜Ÿåˆ—å·²æ»¡){
        // ç­‰å¾…é˜Ÿåˆ—ä¸æ»¡
        notFull.await();
      }  
      // çœç•¥å…¥é˜Ÿæ“ä½œ...
      //å…¥é˜Ÿå,é€šçŸ¥å¯å‡ºé˜Ÿ
      notEmpty.signal();
    }finally {
      lock.unlock();
    }
  }
  // å‡ºé˜Ÿ
  void deq(){
    lock.lock();
    try {
      while (é˜Ÿåˆ—å·²ç©º){
        // ç­‰å¾…é˜Ÿåˆ—ä¸ç©º
        notEmpty.await();
      }  
      // çœç•¥å‡ºé˜Ÿæ“ä½œ...
      //å‡ºé˜Ÿåï¼Œé€šçŸ¥å¯å…¥é˜Ÿ
      notFull.signal();
    }finally {
      lock.unlock();
    }  
  }
}
</code></pre><p>ä¸è¿‡ï¼Œè¿™é‡Œä½ éœ€è¦æ³¨æ„ï¼ŒLockå’ŒConditionå®ç°çš„ç®¡ç¨‹ï¼Œ<strong>çº¿ç¨‹ç­‰å¾…å’Œé€šçŸ¥éœ€è¦è°ƒç”¨await()ã€signal()ã€signalAll()</strong>ï¼Œå®ƒä»¬çš„è¯­ä¹‰å’Œwait()ã€notify()ã€notifyAll()æ˜¯ç›¸åŒçš„ã€‚ä½†æ˜¯ä¸ä¸€æ ·çš„æ˜¯ï¼ŒLock&amp;Conditionå®ç°çš„ç®¡ç¨‹é‡Œåªèƒ½ä½¿ç”¨å‰é¢çš„await()ã€signal()ã€signalAll()ï¼Œè€Œåé¢çš„wait()ã€notify()ã€notifyAll()åªæœ‰åœ¨synchronizedå®ç°çš„ç®¡ç¨‹é‡Œæ‰èƒ½ä½¿ç”¨ã€‚å¦‚æœä¸€ä¸å°å¿ƒåœ¨Lock&amp;Conditionå®ç°çš„ç®¡ç¨‹é‡Œè°ƒç”¨äº†wait()ã€notify()ã€notifyAll()ï¼Œé‚£ç¨‹åºå¯å°±å½»åº•ç©å„¿å®Œäº†ã€‚</p><!-- [[[read_end]]] --><p>Java SDKå¹¶å‘åŒ…é‡Œçš„Lockå’ŒConditionä¸è¿‡å°±æ˜¯ç®¡ç¨‹çš„ä¸€ç§å®ç°è€Œå·²ï¼Œç®¡ç¨‹ä½ å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œé‚£Lockå’ŒConditionçš„ä½¿ç”¨è‡ªç„¶æ˜¯å°èœä¸€ç¢Ÿã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹åœ¨çŸ¥åé¡¹ç›®Dubboä¸­ï¼ŒLockå’ŒConditionæ˜¯æ€ä¹ˆç”¨çš„ã€‚ä¸è¿‡åœ¨å¼€å§‹ä»‹ç»æºç ä¹‹å‰ï¼Œæˆ‘è¿˜å…ˆè¦ä»‹ç»ä¸¤ä¸ªæ¦‚å¿µï¼šåŒæ­¥å’Œå¼‚æ­¥ã€‚</p><h2>åŒæ­¥ä¸å¼‚æ­¥</h2><p>æˆ‘ä»¬å¹³æ—¶å†™çš„ä»£ç ï¼ŒåŸºæœ¬éƒ½æ˜¯åŒæ­¥çš„ã€‚ä½†æœ€è¿‘å‡ å¹´ï¼Œå¼‚æ­¥ç¼–ç¨‹å¤§ç«ã€‚é‚£åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<strong>é€šä¿—ç‚¹æ¥è®²å°±æ˜¯è°ƒç”¨æ–¹æ˜¯å¦éœ€è¦ç­‰å¾…ç»“æœï¼Œå¦‚æœéœ€è¦ç­‰å¾…ç»“æœï¼Œå°±æ˜¯åŒæ­¥ï¼›å¦‚æœä¸éœ€è¦ç­‰å¾…ç»“æœï¼Œå°±æ˜¯å¼‚æ­¥</strong>ã€‚</p><p>æ¯”å¦‚åœ¨ä¸‹é¢çš„ä»£ç é‡Œï¼Œæœ‰ä¸€ä¸ªè®¡ç®—åœ†å‘¨ç‡å°æ•°ç‚¹å100ä¸‡ä½çš„æ–¹æ³•<code>pai1M()</code>ï¼Œè¿™ä¸ªæ–¹æ³•å¯èƒ½éœ€è¦æ‰§è¡Œä¿©ç¤¼æ‹œï¼Œå¦‚æœè°ƒç”¨<code>pai1M()</code>ä¹‹åï¼Œçº¿ç¨‹ä¸€ç›´ç­‰ç€è®¡ç®—ç»“æœï¼Œç­‰ä¿©ç¤¼æ‹œä¹‹åç»“æœè¿”å›ï¼Œå°±å¯ä»¥æ‰§è¡Œ <code>printf("hello world")</code>äº†ï¼Œè¿™ä¸ªå±äºåŒæ­¥ï¼›å¦‚æœè°ƒç”¨<code>pai1M()</code>ä¹‹åï¼Œçº¿ç¨‹ä¸ç”¨ç­‰å¾…è®¡ç®—ç»“æœï¼Œç«‹åˆ»å°±å¯ä»¥æ‰§è¡Œ <code>printf("hello world")</code>ï¼Œè¿™ä¸ªå°±å±äºå¼‚æ­¥ã€‚</p><pre><code>// è®¡ç®—åœ†å‘¨ç‡å°è¯´ç‚¹å100ä¸‡ä½ 
String pai1M() {
  //çœç•¥ä»£ç æ— æ•°
}

pai1M()
printf(&quot;hello world&quot;)
</code></pre><p>åŒæ­¥ï¼Œæ˜¯Javaä»£ç é»˜è®¤çš„å¤„ç†æ–¹å¼ã€‚å¦‚æœä½ æƒ³è®©ä½ çš„ç¨‹åºæ”¯æŒå¼‚æ­¥ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢ä¸¤ç§æ–¹å¼æ¥å®ç°ï¼š</p><ol>
<li>è°ƒç”¨æ–¹åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹ï¼Œåœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œæ–¹æ³•è°ƒç”¨ï¼Œè¿™ç§è°ƒç”¨æˆ‘ä»¬ç§°ä¸ºå¼‚æ­¥è°ƒç”¨ï¼›</li>
<li>æ–¹æ³•å®ç°çš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œä¸»è¦é€»è¾‘ï¼Œä¸»çº¿ç¨‹ç›´æ¥returnï¼Œè¿™ç§æ–¹æ³•æˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºå¼‚æ­¥æ–¹æ³•ã€‚</li>
</ol><h2>Dubboæºç åˆ†æ</h2><p>å…¶å®åœ¨ç¼–ç¨‹é¢†åŸŸï¼Œå¼‚æ­¥çš„åœºæ™¯è¿˜æ˜¯æŒºå¤šçš„ï¼Œæ¯”å¦‚TCPåè®®æœ¬èº«å°±æ˜¯å¼‚æ­¥çš„ï¼Œæˆ‘ä»¬å·¥ä½œä¸­ç»å¸¸ç”¨åˆ°çš„RPCè°ƒç”¨ï¼Œ<strong>åœ¨TCPåè®®å±‚é¢ï¼Œå‘é€å®ŒRPCè¯·æ±‚åï¼Œçº¿ç¨‹æ˜¯ä¸ä¼šç­‰å¾…RPCçš„å“åº”ç»“æœçš„</strong>ã€‚å¯èƒ½ä½ ä¼šè§‰å¾—å¥‡æ€ªï¼Œå¹³æ—¶å·¥ä½œä¸­çš„RPCè°ƒç”¨å¤§å¤šæ•°éƒ½æ˜¯åŒæ­¥çš„å•Šï¼Ÿè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>å…¶å®å¾ˆç®€å•ï¼Œä¸€å®šæ˜¯æœ‰äººå¸®ä½ åšäº†å¼‚æ­¥è½¬åŒæ­¥çš„äº‹æƒ…ã€‚ä¾‹å¦‚ç›®å‰çŸ¥åçš„RPCæ¡†æ¶Dubboå°±ç»™æˆ‘ä»¬åšäº†å¼‚æ­¥è½¬åŒæ­¥çš„äº‹æƒ…ï¼Œé‚£å®ƒæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å°±æ¥åˆ†æä¸€ä¸‹Dubboçš„ç›¸å…³æºç ã€‚</p><p>å¯¹äºä¸‹é¢ä¸€ä¸ªç®€å•çš„RPCè°ƒç”¨ï¼Œé»˜è®¤æƒ…å†µä¸‹sayHello()æ–¹æ³•ï¼Œæ˜¯ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œservice.sayHello(â€œdubboâ€)çš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šåœä¸‹æ¥ç­‰ç»“æœã€‚</p><pre><code>DemoService service = åˆå§‹åŒ–éƒ¨åˆ†çœç•¥
String message = 
  service.sayHello(&quot;dubbo&quot;);
System.out.println(message);
</code></pre><p>å¦‚æœæ­¤æ—¶ä½ å°†è°ƒç”¨çº¿ç¨‹dumpå‡ºæ¥çš„è¯ï¼Œä¼šæ˜¯ä¸‹å›¾è¿™ä¸ªæ ·å­ï¼Œä½ ä¼šå‘ç°è°ƒç”¨çº¿ç¨‹é˜»å¡äº†ï¼Œçº¿ç¨‹çŠ¶æ€æ˜¯TIMED_WAITINGã€‚æœ¬æ¥å‘é€è¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯è°ƒç”¨çº¿ç¨‹å´é˜»å¡äº†ï¼Œè¯´æ˜Dubboå¸®æˆ‘ä»¬åšäº†å¼‚æ­¥è½¬åŒæ­¥çš„äº‹æƒ…ã€‚é€šè¿‡è°ƒç”¨æ ˆï¼Œä½ èƒ½çœ‹åˆ°çº¿ç¨‹æ˜¯é˜»å¡åœ¨DefaultFuture.get()æ–¹æ³•ä¸Šï¼Œæ‰€ä»¥å¯ä»¥æ¨æ–­ï¼šDubboå¼‚æ­¥è½¬åŒæ­¥çš„åŠŸèƒ½åº”è¯¥æ˜¯é€šè¿‡DefaultFutureè¿™ä¸ªç±»å®ç°çš„ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/a9/c5/a924d23fc43d31267473f2dc91396ec5.png" alt=""></p><center><span class="reference">è°ƒç”¨æ ˆä¿¡æ¯</span></center><p>ä¸è¿‡ä¸ºäº†ç†æ¸…å‰åå…³ç³»ï¼Œè¿˜æ˜¯æœ‰å¿…è¦åˆ†æä¸€ä¸‹è°ƒç”¨DefaultFuture.get()ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆã€‚DubboInvokerçš„108è¡Œè°ƒç”¨äº†DefaultFuture.get()ï¼Œè¿™ä¸€è¡Œå¾ˆå…³é”®ï¼Œæˆ‘ç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹åˆ—åœ¨äº†ä¸‹é¢ã€‚è¿™ä¸€è¡Œå…ˆè°ƒç”¨äº†request(inv, timeout)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å…¶å®å°±æ˜¯å‘é€RPCè¯·æ±‚ï¼Œä¹‹åé€šè¿‡è°ƒç”¨get()æ–¹æ³•ç­‰å¾…RPCè¿”å›ç»“æœã€‚</p><pre><code>public class DubboInvoker{
  Result doInvoke(Invocation inv){
    // ä¸‹é¢è¿™è¡Œå°±æ˜¯æºç ä¸­108è¡Œ
    // ä¸ºäº†ä¾¿äºå±•ç¤ºï¼Œåšäº†ä¿®æ”¹
    return currentClient 
      .request(inv, timeout)
      .get();
  }
}
</code></pre><p>DefaultFutureè¿™ä¸ªç±»æ˜¯å¾ˆå…³é”®ï¼Œæˆ‘æŠŠç›¸å…³çš„ä»£ç ç²¾ç®€ä¹‹åï¼Œåˆ—åˆ°äº†ä¸‹é¢ã€‚ä¸è¿‡åœ¨çœ‹ä»£ç ä¹‹å‰ï¼Œä½ è¿˜æ˜¯æœ‰å¿…è¦é‡å¤ä¸€ä¸‹æˆ‘ä»¬çš„éœ€æ±‚ï¼šå½“RPCè¿”å›ç»“æœä¹‹å‰ï¼Œé˜»å¡è°ƒç”¨çº¿ç¨‹ï¼Œè®©è°ƒç”¨çº¿ç¨‹ç­‰å¾…ï¼›å½“RPCè¿”å›ç»“æœåï¼Œå”¤é†’è°ƒç”¨çº¿ç¨‹ï¼Œè®©è°ƒç”¨çº¿ç¨‹é‡æ–°æ‰§è¡Œã€‚ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰ï¼Œè¿™ä¸å°±æ˜¯ç»å…¸çš„ç­‰å¾…-é€šçŸ¥æœºåˆ¶å—ï¼Ÿè¿™ä¸ªæ—¶å€™æƒ³å¿…ä½ çš„è„‘æµ·é‡Œåº”è¯¥èƒ½å¤Ÿæµ®ç°å‡ºç®¡ç¨‹çš„è§£å†³æ–¹æ¡ˆäº†ã€‚æœ‰äº†è‡ªå·±çš„æ–¹æ¡ˆä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹Dubboæ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p><pre><code>// åˆ›å»ºé”ä¸æ¡ä»¶å˜é‡
private final Lock lock 
    = new ReentrantLock();
private final Condition done 
    = lock.newCondition();

// è°ƒç”¨æ–¹é€šè¿‡è¯¥æ–¹æ³•ç­‰å¾…ç»“æœ
Object get(int timeout){
  long start = System.nanoTime();
  lock.lock();
  try {
	while (!isDone()) {
	  done.await(timeout);
      long cur=System.nanoTime();
	  if (isDone() || 
          cur-start &gt; timeout){
	    break;
	  }
	}
  } finally {
	lock.unlock();
  }
  if (!isDone()) {
	throw new TimeoutException();
  }
  return returnFromResponse();
}
// RPCç»“æœæ˜¯å¦å·²ç»è¿”å›
boolean isDone() {
  return response != null;
}
// RPCç»“æœè¿”å›æ—¶è°ƒç”¨è¯¥æ–¹æ³•   
private void doReceived(Response res) {
  lock.lock();
  try {
    response = res;
    if (done != null) {
      done.signal();
    }
  } finally {
    lock.unlock();
  }
}
</code></pre><p>è°ƒç”¨çº¿ç¨‹é€šè¿‡è°ƒç”¨get()æ–¹æ³•ç­‰å¾…RPCè¿”å›ç»“æœï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œä½ çœ‹åˆ°çš„éƒ½æ˜¯ç†Ÿæ‚‰çš„â€œé¢å­”â€ï¼šè°ƒç”¨lock()è·å–é”ï¼Œåœ¨finallyé‡Œé¢è°ƒç”¨unlock()é‡Šæ”¾é”ï¼›è·å–é”åï¼Œé€šè¿‡ç»å…¸çš„åœ¨å¾ªç¯ä¸­è°ƒç”¨await()æ–¹æ³•æ¥å®ç°ç­‰å¾…ã€‚</p><p>å½“RPCç»“æœè¿”å›æ—¶ï¼Œä¼šè°ƒç”¨doReceived()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œè°ƒç”¨lock()è·å–é”ï¼Œåœ¨finallyé‡Œé¢è°ƒç”¨unlock()é‡Šæ”¾é”ï¼Œè·å–é”åé€šè¿‡è°ƒç”¨signal()æ¥é€šçŸ¥è°ƒç”¨çº¿ç¨‹ï¼Œç»“æœå·²ç»è¿”å›ï¼Œä¸ç”¨ç»§ç»­ç­‰å¾…äº†ã€‚</p><p>è‡³æ­¤ï¼ŒDubboé‡Œé¢çš„å¼‚æ­¥è½¬åŒæ­¥çš„æºç å°±åˆ†æå®Œäº†ï¼Œæœ‰æ²¡æœ‰è§‰å¾—è¿˜æŒºç®€å•çš„ï¼Ÿæœ€è¿‘è¿™å‡ å¹´ï¼Œå·¥ä½œä¸­éœ€è¦å¼‚æ­¥å¤„ç†çš„è¶Šæ¥è¶Šå¤šäº†ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªä¸»è¦åŸå› å°±æ˜¯æœ‰äº›APIæœ¬èº«å°±æ˜¯å¼‚æ­¥APIã€‚ä¾‹å¦‚websocketä¹Ÿæ˜¯ä¸€ä¸ªå¼‚æ­¥çš„é€šä¿¡åè®®ï¼Œå¦‚æœåŸºäºè¿™ä¸ªåè®®å®ç°ä¸€ä¸ªç®€å•çš„RPCï¼Œä½ ä¹Ÿä¼šé‡åˆ°å¼‚æ­¥è½¬åŒæ­¥çš„é—®é¢˜ã€‚ç°åœ¨å¾ˆå¤šå…¬æœ‰äº‘çš„APIæœ¬èº«ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œä¾‹å¦‚åˆ›å»ºäº‘ä¸»æœºï¼Œå°±æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„APIï¼Œè°ƒç”¨è™½ç„¶æˆåŠŸäº†ï¼Œä½†æ˜¯äº‘ä¸»æœºå¹¶æ²¡æœ‰åˆ›å»ºæˆåŠŸï¼Œä½ éœ€è¦è°ƒç”¨å¦å¤–ä¸€ä¸ªAPIå»è½®è¯¢äº‘ä¸»æœºçš„çŠ¶æ€ã€‚å¦‚æœä½ éœ€è¦åœ¨é¡¹ç›®å†…éƒ¨å°è£…åˆ›å»ºäº‘ä¸»æœºçš„APIï¼Œä½ ä¹Ÿä¼šé¢ä¸´å¼‚æ­¥è½¬åŒæ­¥çš„é—®é¢˜ï¼Œå› ä¸ºåŒæ­¥çš„APIæ›´æ˜“ç”¨ã€‚</p><h2>æ€»ç»“</h2><p>Lock&amp;Conditionæ˜¯ç®¡ç¨‹çš„ä¸€ç§å®ç°ï¼Œæ‰€ä»¥èƒ½å¦ç”¨å¥½Lockå’ŒConditionè¦çœ‹ä½ å¯¹ç®¡ç¨‹æ¨¡å‹ç†è§£å¾—æ€ä¹ˆæ ·ã€‚ç®¡ç¨‹çš„æŠ€æœ¯å‰é¢æˆ‘ä»¬å·²ç»ä¸“é—¨ç”¨äº†ä¸€ç¯‡æ–‡ç« åšäº†ä»‹ç»ï¼Œä½ å¯ä»¥ç»“åˆç€æ¥å­¦ï¼Œç†è®ºè”ç³»å®è·µï¼Œæœ‰åŠ©äºåŠ æ·±ç†è§£ã€‚</p><p>Lock&amp;Conditionå®ç°çš„ç®¡ç¨‹ç›¸å¯¹äºsynchronizedå®ç°çš„ç®¡ç¨‹æ¥è¯´æ›´åŠ çµæ´»ã€åŠŸèƒ½ä¹Ÿæ›´ä¸°å¯Œã€‚</p><p>ç»“åˆæˆ‘è‡ªå·±çš„ç»éªŒï¼Œæˆ‘è®¤ä¸ºäº†è§£åŸç†æ¯”äº†è§£å®ç°æ›´èƒ½è®©ä½ å¿«é€Ÿå­¦å¥½å¹¶å‘ç¼–ç¨‹ï¼Œæ‰€ä»¥æ²¡æœ‰ä»‹ç»å¤ªå¤šJava SDKå¹¶å‘åŒ…é‡Œé”å’Œæ¡ä»¶å˜é‡æ˜¯å¦‚ä½•å®ç°çš„ã€‚ä½†å¦‚æœä½ å¯¹å®ç°æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒ<a href="https://h5.youzan.com/v2/goods/35z7jjvd4r4oo">ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</a>ä¸€ä¹¦çš„ç¬¬5ç« ã€ŠJavaä¸­çš„é”ã€‹ï¼Œé‡Œé¢è¯¦ç»†ä»‹ç»äº†å®ç°åŸç†ï¼Œæˆ‘è§‰å¾—å†™å¾—éå¸¸å¥½ã€‚</p><p>å¦å¤–ï¼Œä¸“æ é‡Œå¯¹DefaultFutureçš„ä»£ç ç¼©å‡äº†å¾ˆå¤šï¼Œå¦‚æœä½ æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥å»çœ‹çœ‹å®Œæ•´ç‰ˆã€‚<br>
Dubboçš„æºä»£ç åœ¨<a href="https://github.com/apache/incubator-dubbo">Githubä¸Š</a>ï¼ŒDefaultFutureçš„è·¯å¾„æ˜¯ï¼šincubator-dubbo/dubbo-remoting/dubbo-remoting-api/src/main/java/org/apache/dubbo/remoting/exchange/support/DefaultFuture.javaã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>DefaultFutureé‡Œé¢å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ï¼Œç”¨çš„æ˜¯signal()ï¼Œè€Œä¸æ˜¯signalAll()ï¼Œä½ æ¥åˆ†æä¸€ä¸‹ï¼Œè¿™æ ·åšæ˜¯å¦åˆç†å‘¢ï¼Ÿ</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><h1>çŒœä½ å–œæ¬¢</h1><p><a href="https://time.geekbang.org/course/intro/156?utm_term=zeusRVDGT&amp;utm_source=app&amp;utm_medium=javabingfabiancheng&amp;utm_campaign=156-onsell&amp;utm_content=banner0301"><img src="https://static001.geekbang.org/resource/image/8e/93/8e1906fb8a24d5eb66539fa88ea56193.png" alt="unpreview"></a></p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å¤©æ¶¯ç…®é…’  2019-04-02 01:00:41
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            åˆç†ã€‚<br><br>æ¯ä¸ªrpcè¯·æ±‚éƒ½ä¼šå ç”¨ä¸€ä¸ªçº¿ç¨‹å¹¶äº§ç”Ÿä¸€ä¸ªæ–°çš„DefaultFutureå®ä¾‹ï¼Œå®ƒä»¬çš„lock&amp;conditionæ˜¯ä¸åŒçš„ï¼Œå¹¶æ²¡æœ‰ç«äº‰å…³ç³»<br><br>è¿™é‡Œçš„lock&amp;conditionæ˜¯ç”¨æ¥åšå¼‚æ­¥è½¬åŒæ­¥çš„ï¼Œä½¿get()æ–¹æ³•ä¸å¿…ç­‰å¾…timeouté‚£ä¹ˆä¹…ï¼Œç”¨å¾—å¾ˆå·§å¦™ [16èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            ZOUå¿—ä¼Ÿ  2019-04-03 18:34:33
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            ä¸åˆç†ï¼Œä¼šå¯¼è‡´å¾ˆå¤šè¯·æ±‚è¶…æ—¶ï¼Œçœ‹äº†æºç æ˜¯è°ƒç”¨signalAll() [10èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-03 20:17:00</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">å†™è¿™ä¸€ç« çš„æ—¶å€™è¿˜æ˜¯signalï¼Œåæ¥æœ‰äººæäº†ä¸ªbugï¼Œå°±æ”¹æˆsignalalläº†<br></div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            10buns  2019-04-04 01:34:11
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            signalå”¤é†’ä»»æ„ä¸€ä¸ªçº¿ç¨‹ç«äº‰é”ï¼ŒsignalAllå”¤é†’åŒä¸€ä¸ªæ¡ä»¶å˜é‡çš„æ‰€æœ‰çº¿ç¨‹ç«äº‰é”ã€‚ä½†éƒ½åªæœ‰ä¸€ä¸ªçº¿ç¨‹è·å¾—é”æ‰§è¡Œã€‚åŒºåˆ«åªæ˜¯è¢«å”¤é†’çº¿ç¨‹çš„æ•°é‡ã€‚<br>æ‰€ä»¥ç”¨signalallå¯ä»¥é¿å…æç«¯æƒ…å†µçº¿ç¨‹åªèƒ½ç­‰å¾…è¶…æ—¶ï¼Œçœ‹äº†ä»£ç ä¹Ÿæ˜¯æ›¿ä»£äº†signal [4èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            åˆ˜ç« å‘¨  2019-04-02 09:16:36
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å›å¤ï¼šå¯†ç 12345åŒå­¦ï¼Œå¦‚æœæ˜¯å•ä¾‹å¯¹è±¡ï¼Œresponseå²‚ä¸æ˜¯ä¹±å¥—äº†ï¼Œæ¯ä¸€ä¸ªè¯·æ±‚éƒ½å¯¹åº”è‡ªå·±çš„ responseã€‚å¦å¤–singal()æ˜¯åˆç†çš„ã€‚å› ä¸ºæ¯ä¸€ä¸ªä¸»çº¿ç¨‹å¯¹åº”ä¸€ä¸ªå­çº¿ç¨‹ï¼Œä¸å¯èƒ½å­˜åœ¨ä¸€ä¸ªå­çº¿ç¨‹å¯¹åº”å¤šä¸ªè¯·æ±‚ã€‚ [2èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            zhangtnty  2019-04-02 07:57:44
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            åˆç†ï¼Œç­‰å¾…æ¡ä»¶éƒ½æ˜¯responseä¸ç©ºï¼Œç­‰åˆ°é€šçŸ¥åçš„åŠ¨ä½œéƒ½æ˜¯è¿”å›response,ä¹Ÿæ˜¯é€šçŸ¥ä¸€ä¸ªçº¿ç¨‹ã€‚<br>è€å¸ˆï¼Œæ‚¨åœ¨æ–‡ä¸­æåˆ°ï¼Œå­çº¿ç¨‹å’Œæ–°çº¿ç¨‹ï¼Œä»£ç ä¸Šæ€ä¹ˆåŒºåˆ†å‘¢ï¼Ÿæˆ‘è®¤ä¸ºåœ¨mainä¸­new thread,å³ä½¿ç«‹åˆ»è¿”å›main,ä¹Ÿå¾—åœ¨new threadä¹‹åã€‚è¿™æ˜¯å­çº¿ç¨‹è¿˜æ˜¯æ–°çº¿ç¨‹å‘¢ï¼Ÿ [2èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-03 20:13:12</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">åˆ›å»ºæ–°çº¿ç¨‹å’Œåˆ›å»ºå­çº¿ç¨‹æ²¡åŒºåˆ«ï¼Œéƒ½æ˜¯çº¦å®šä¿—æˆçš„è¯´æ³•è€Œå·²<br></div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å¼ å¤©å±¹  2019-04-04 11:36:35
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æˆ‘ç†è§£å¼‚æ­¥çš„æœ¬è´¨æ˜¯åˆ©ç”¨å¤šçº¿ç¨‹æå‡æ€§èƒ½ï¼Œå¼‚æ­¥ä¸€å®šæ˜¯åŸºäºä¸€ä¸ªæ–°å¼€çš„çº¿ç¨‹ï¼Œä»è°ƒç”¨çº¿ç¨‹æ¥çœ‹æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯ä»æ–°å¼€çš„é‚£ä¸ªçº¿ç¨‹æ¥çœ‹ï¼Œæ­£æ˜¯åŒæ­¥ï¼ˆç­‰å¾…ï¼‰çš„ï¼Œåªæ˜¯å¯¹äºè°ƒç”¨æ–¹è€Œè¨€è¿™ç§åŒæ­¥æ˜¯é€æ˜çš„ã€‚æ­£æ‰€è°“ç”Ÿæ´»å“ªæœ‰ä»€ä¹ˆå²æœˆé™å¥½ï¼Œåªæ˜¯æœ‰äººæ›¿ä½ è´Ÿé‡å‰è¡Œã€‚ [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-04 20:13:14</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">æ€»ç»“çš„å¤ªæœ‰æ–‡é‡‡äº†ï¼å¼‚æ­¥åŠ ä¸Šéé˜»å¡IOæ‰æœ‰å¨åŠ›<br></div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Wè¦æ”¹ä¸ªç½‘å  2019-04-03 14:37:08
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆï¼Œæœ‰ä¸ªç–‘é—®<br>ä¸ºä»€ä¹ˆè¦åˆ¤æ–­done!=nullå‘¢ï¼Ÿè¿™ä¸ªæ¡ä»¶ä¸æ˜¯æ°¸è¿œä¸ºtrueå—ã€‚ [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-03 20:17:56</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">æœ€æ–°çš„ä»£ç ä»–ä»¬å·²ç»æ”¹è¿‡æ¥äº†ğŸ˜ƒ</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            ban  2019-04-03 09:28:37
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆï¼Œæ±‚æŒ‡æ•™<br>DefaultFuturewhileè¿™ä¸ªç±»ä¸ºä»€ä¹ˆè¦åŠ  while(!isDone()) è¿™ä¸ªæ¡ä»¶ï¼Œæˆ‘çœ‹ä»£ç whileé‡Œé¢åŠ äº†done.await(timeout);æ˜¯æ”¯æŒè¶…æ—¶çš„ï¼Œå°±æ˜¯è¯´è®¾ç½®5ç§’è¶…æ—¶ï¼Œ if (isDone() || cur-start &gt; timeout){ï¼Œåªè¦è¶…è¿‡æ²¡æœ‰è¢«signal()å”¤é†’ï¼Œé‚£5ç§’å°±ä¼šè‡ªåŠ¨å”¤é†’ï¼Œè¿™æ—¶å€™å°±ä¼šåœ¨if (isDone() || cur-start &gt; timeout){ è¢«æ ¡éªŒé€šè¿‡ï¼Œä»è€Œbreakï¼Œé€€å‡ºã€‚è¿™æ—¶å€™åœ¨åŠ ä¸ªwhileæ¡ä»¶æ˜¯ä¸æ˜¯æ²¡å¿…è¦ã€‚<br>è¿˜æ˜¯è¯´åŠ ä¸ªwhileæ¡ä»¶æ˜¯å› ä¸ºæ—¶é—´åˆ°ç‚¹çš„æ—¶å€™è‡ªåŠ¨å”¤é†’åï¼ŒResponseå¯èƒ½æ˜¯ç©ºï¼Œè€Œä¸”æ—¶é—´cur-start &gt; timeout ä¸è¶…æ—¶ï¼Œæ‰€ä»¥æ‰æœ‰å¿…è¦è¿›è¡Œwhileå†ä¸€æ¬¡åˆ¤æ–­isDone()æ˜¯å¦æœ‰å€¼ã€‚ [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-03 20:01:36</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">whileæ¡ä»¶æ˜¯ç¼–ç¨‹èŒƒå¼ï¼Œå¯ä»¥å›å»çœ‹ç®¡ç¨‹åŸç†ï¼Œæå·¥ç¨‹è¦å¤šé‡é˜²æŠ¤ã€‚è¶…æ—¶åå½“ç„¶å¾ˆæœ‰å¯èƒ½respæ˜¯ç©ºçš„</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            æœ¨åˆ»  2019-04-02 11:54:09
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆä»Šå¤©æåˆ°å¼‚æ­¥è½¬åŒæ­¥ï¼Œè®©æˆ‘æƒ³åˆ°è¿™ä¸¤å¤©çœ‹çš„zookeeperå®¢æˆ·ç«¯æºç ï¼Œæ„Ÿè§‰åº”è¯¥ä¹Ÿæ˜¯è¿™ä¸ªæœºåˆ¶ï¼Œå®¢æˆ·ç«¯åŒæ­¥æ¨¡å¼ä¸‹å‘é€è¯·æ±‚åä¼šæ‰§è¡Œpacket.waitï¼Œæ”¶åˆ°æœåŠ¡ç«¯å“åº”åæ‰§è¡Œpacket.notifyAll [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-02 22:57:36</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">ğŸ‘<br></div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            JGOS  2019-04-16 23:24:26
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆ,åœ¨è¿›å…¥ç­‰å¾…ä¹‹å‰çš„ä¸ºä»€ä¹ˆéƒ½æ˜¯ç”¨while()è¿›è¡Œåˆ¤æ–­å•Š, awaitå’Œwaitæ–¹æ³•ä¸æ˜¯è®²æŒæœ‰é”çš„çº¿ç¨‹æŒ‚èµ·å—,ä¸ºä»€ä¹ˆä¸ç”¨ifåšåˆ¤æ–­å•Š 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            çº¦ä¹¦äºš  2019-04-06 07:48:20
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æˆ‘æœ‰ç‚¹ä¸ç†è§£ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤šè¯´åˆç†çš„åŒå­¦ï¼ŒFutureè¿™ç§ç±»ä¸åº”è¯¥ç»å¸¸ç”±äºç”¨åœ¨é—­åŒ…ä¸­ï¼Œå¯¼è‡´åœ¨å¤šçº¿ç¨‹å¤šä¸Šä¸‹æ–‡ä¸­ä¼ é€’å˜›ï¼Ÿå¦‚æœæˆ‘æœ‰å¤šä¸ªçº¿ç¨‹éƒ½å¯¹åŒä¸€ä¸ªDefaultFutureå®ä¾‹è°ƒç”¨getï¼Œè€Œæ¯ä¸ªè¢«å”¤é†’çš„çº¿ç¨‹åˆä¸signalå…¶ä»–çº¿ç¨‹ï¼Œé‚£ä¸å°±æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æœ€ç»ˆä¼šè¢«å”¤é†’ï¼Œå…¶ä»–è°ƒç”¨getçš„çº¿ç¨‹éƒ½æ˜¯å› ä¸ºè¶…æ—¶è·å–åˆ°çš„ç»“æœå˜›ï¼Ÿ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            é‡è§é˜³å…‰  2019-04-05 13:53:14
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸‹locksupportä¸æ­¤å¤„ç”¨lockæ¥é˜»å¡è°ƒç”¨è€…çº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ« 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-05 23:40:11</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">lockåº•å±‚æ˜¯ç”¨locksupportå®ç°çš„</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            æœç„¶å¦‚æ­¤  2019-04-03 08:49:22
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            åšè¿‡ä¸€ä¸ªç”¨webkitæŠ“å–ç½‘é¡µçš„çˆ¬è™«å°±æ˜¯å¼‚æ­¥è½¬åŒæ­¥ï¼Œwhileå¾ªç¯é‡Œåˆ¤æ–­ä¸€ä¸ªå…±äº«å˜é‡çŠ¶æ€æ˜¯å¦å®Œæˆé¡µé¢åŠ è½½ï¼Œå¾ªç¯å†…éƒ¨æœ‰sleepç­‰å¾…ï¼Œè¿˜æœ‰è¶…æ—¶åˆ¤æ–­åbreakã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            QQæ€ª  2019-04-02 22:31:06
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æˆ‘è§‰å¾—å¾ˆåˆç†ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½ä¼šå®ä¾‹åŒ–ä¸ªDefactFeture,æ‰€ä»¥æ¯ä¸ªè¯·æ±‚ä¸€ä¸ªlockï¼Œæ˜ç¡®çŸ¥é“éœ€è¦å”¤é†’å“ªä¸ªçº¿ç¨‹åº”è¯¥ç”¨asign()ï¼ŒåŒæ ·è¿™æ ·åšæ³•ä¹Ÿæ˜¯ä¸ºäº†åº”å¯¹é«˜å¹¶å‘æƒ…å†µä¸‹çš„å¼‚æ­¥è½¬åŒæ­¥éœ€æ±‚å§ï¼ä¸çŸ¥é“å¯¹ä¸å¯¹?ğŸ˜‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            liurh  2019-04-02 21:13:00
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆï¼Œjdkå·²ç»å®ç°äº†Futureå»æŠŠå¼‚æ­¥è½¬æ¢ä¸ºåŒæ­¥ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨get()æ–¹æ³•å°±ä¼šè®©çº¿ç¨‹é˜»å¡çš„è·å–çº¿ç¨‹æ‰§è¡Œç»“æœï¼Œä¸ºä»€ä¹ˆdubboè¿˜è¦è‡ªå·±å®ç°MESAæ¨¡å‹ï¼Œä¸å¤ªç†è§£ã€‚ä¸šåŠ¡ä¸­ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥ç”¨è¿™ä¸ªæ¨¡å‹ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-04-02 22:54:10</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">è¿™ä¸ªæ‡‚nettyå°±çŸ¥é“äº†ï¼Œä¸€èˆ¬å·¥å…·ç±»æä¸å®šäº†å°±ç”¨å®ƒ<br></div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            ken  2019-04-02 19:46:16
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            åˆç† 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            æµ·è¿å¤©  2019-04-02 18:40:34
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å¯èƒ½ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºè¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œå¦‚æœç‰¹æ®Šåœºæ™¯ä¸‹è°ƒç”¨done.awaitä¹‹å‰ï¼Œå·²ç»è°ƒç”¨è¿‡done.signalï¼Œå¯èƒ½ä¼šå¯¼è‡´ç­‰å¾…çš„çº¿ç¨‹è¶…æ—¶ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            ack  2019-04-02 13:50:56
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            åˆç†ï¼Œåªæœ‰ä¸€ä¸ªç­‰å¾…æ¡ä»¶ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            èƒ¡æ¡¥  2019-04-02 10:43:35
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            notEmptyå’ŒnotFullå°†ä¸¤ä¸ªä¹‹å‰ç”¨ä¸šåŠ¡ä»£ç åˆ¤æ–­çš„æ¡ä»¶å½»åº•åˆ†å¼€äº†ï¼Œå› æ­¤ä¹‹å‰ç”¨synchronized-wait-notify-notifyAllæ–¹å¼æ—¶â€œä¸€ä¸ªé”é”å¤šä¸ªæ¡ä»¶â€çš„æƒ…å†µå°±ä¸å­˜åœ¨äº†ã€‚å› æ­¤signalå«é†’çš„ä¸€ä¸ªçº¿ç¨‹è‚¯å®šæ˜¯ä¸€ä¸ªâ€œå¯¹çš„â€çº¿ç¨‹ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            suke  2019-04-02 10:13:07
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆèƒ½å…·ä½“è¯´ä¸€è¯´åˆ›å»ºäº‘ä¸»æœºå¼‚æ­¥è½¬åŒæ­¥çš„é—®é¢˜ä¹ˆï¼Œå°¤å…¶æ˜¯é‡åˆ°å†…éƒ¨ç¡¬ä»¶èµ„æºï¼ˆå†…å­˜ã€cpuç­‰ï¼‰ä¸è¶³æ—¶ï¼Œå¼‚æ­¥çš„çº¿ç¨‹éœ€è¦å¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µ 
        </div>
        
    </div>
</li>
            </ul>
</div>
</body>
</html>